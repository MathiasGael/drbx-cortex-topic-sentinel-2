<?xml version="1.0" encoding="ISO-8859-1" standalone="yes"?>

<!DOCTYPE rdf:RDF [
   <!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#">
   <!ENTITY owl "http://www.w3.org/2002/07/owl#">
   <!ENTITY s2   "http://www.esa.int/s2#">
   <!ENTITY drb "http://www.gael.fr/drb#">
   <!ENTITY jpeg "http://www.gael.fr/drb/jpeg#">
]>

<rdf:RDF xmlns:owl="&owl;"
         xmlns:rdf="&rdf;"
         xmlns:rdfs="&rdfs;"
         xmlns:drb="&drb;"
         xmlns:jpeg="&jpeg;"
         xmlns:s2="&s2;"
         xml:base="&s2;">

<!--
* Data Hub Service (DHuS) - For Space data distribution.
* Copyright (C) 2013,2014,2015,2016 GAEL Systems
*
* This file is part of DHuS software sources.
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU Affero General Public License as
* published by the Free Software Foundation, either version 3 of the
* License, or (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU Affero General Public License for more details.
*
* You should have received a copy of the GNU Affero General Public License
* along with this program. If not, see <http://www.gnu.org/licenses/>.
-->

   <owl:Ontology rdf:about="&s2;">
      <rdfs:label xml:lang="en">Sentinel-2 User Products Commons Ontology</rdfs:label>
   </owl:Ontology>

   <!-- =================================================================== -->
   <!--                                                                     -->
   <!-- Products                                                            -->
   <!--                                                                     -->
   <!-- =================================================================== -->

   <!-- ============================ -->
   <!-- User Product                 -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProduct">
      <rdfs:label xml:lang="en">Sentinel-2 User Product</rdfs:label>
      <rdfs:comment xml:lang="en">
         User Product is the product delivered to the End User corresponding to:
         * A user-defined geographical product subset along the spacecraft orbit;
         * A user-defined selection of product independent components specified
         as download options (e.g. image data, browse image, preview image,
         spectral bands, auxiliary data, ancillary data,
         brief/standard/expertise metadata etc..) according to different user
         authorizations.
         From the End User point of view, PDIs and PDI organization are aspects
         completely transparent. The end user selects from the catalogue a
         defined geographical area or subscribes a request and the final
         product is available on its hard disk.
         The selection from the catalogue follows two different ways:
         * interactively: the user select from graphical interface a
         user-defined geographical area in a given time range, the catalogue
         shows the datatakes intersecting in time and space the submitted
         query. Given a datatake the user can decide to download the whole
         datatake or a portion i.e. a sub-set contiguous of the granules
         contained in the datatake.
         * By subscription: the user select a user-defined geographical area
         and a frequency time, the catalogue systematically will provide to the
         user the whole datatake or a set of the granules every time that a
         data corresponding to the subscribed query will be available.
         Regardless of used approach, the system will receive from the
         catalogue the list of the PDI_ID of the granules corresponding to the
         user selection coinciding with the ID of the archived PDI. Through the
         use of this list the corresponding PDI (granule and Datastrip) are
         restored to assemble the final product.
         From the system (PDGS) point of view, User Product is composed by a
         set of granules. All granules intersecting/touching the region of
         interest of the user are provided into the final products The system,
         based on the download options, downloads in a specific repository for
         example a set of the bands, a set of the metadata according to user
         category (brief/standard/expertise) or all product components.
         Once we have collected the required product components, the User
         Product is pakaged in a configured repository in SAFE or DIMAP format
         according to a specified download-option.
         Taking into account the strategy used to archived the PDIs (see
         [CCTS-US]) the granules selected to assembly the User Product will be
         contiguous in terms of the sensing time, acquired with the same
         operation mode and in the same imaging orbit, corresponding to the
         same processing level. In other words, User Product refers always to a
         given Datatake (continuous MSI imaging segment). In the particular
         case of an instrument mode changes during an imaging orbit, distinct
         products will be made available, one per Datatake.
         User Product containing the entire Datatake is defined as
         Datatake-Product; it is a particular case of a User Product
         exhaustively embedding all granules and all product components (e.g.
         spectral bands, metadata, etc) along the Datatake.
         Therefore, a User Product may be composed by:
         * all granules sharing the same Datatake_ID (Datatake-Product)
         * all granules sharing the same Datatake_ID within a given selection.
         In terms of Datastrip, a User Product may however include several
         Datastrips corresponding to distinct and complementary acquisitions
         on-ground of a same Datatake acquired on-board.
         For the particular case of the Level-0 products for which bands are
         not co-registered, the selected granules will be those where the
         user-defined area intersects the granule envelope (i.e. the union of
         the footprints of all bands).
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&s2;product"/>
      <drb:signature rdf:parseType="Resource">
         <!-- NB signature before COMPACT support
         <drb:nameMatch>S2[AB]_...._PRD_MSI(L0P|L1A|L1B|L1C|L2A|TCI)_PDMC_.*\.SAFE</drb:nameMatch>
         -->
         <drb:nameMatch>S2[AB]_(...._PRD_MSI(L0P|L1A|L1B|L1C|L2A|TCI)_PDMC|MSIL..)_.*\.SAFE</drb:nameMatch>
      </drb:signature>
   </owl:Class>

   <!-- =================================================================== -->
   <!--                                                                     -->
   <!-- User Product Structure (Floor 1)                                    -->
   <!--                                                                     -->
   <!-- =================================================================== -->

   <!-- ============================ -->
   <!-- Product Metadata File        -->
   <!-- ============================ -->

   <!-- TODO ATTENTION changement d'ID <owl:Class rdf:about="&s2;pdi_metadata"> -->
   <!-- Compliant with COMPACT NO MODIFICATION REQUIRED? TBC -->
   <owl:Class rdf:about="&s2;userProductMetadataFile">
      <rdfs:label xml:lang="en">User Product: Main Metadata File</rdfs:label>
      <rdfs:comment xml:lang="en">
         Mandatory XML main metadata file (DIMAP) containing the requested
         level of information and referring all the product elements.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;xml"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>S2[AB]_...._MTD_(SAF|DMP)L(0P|1A|1B|1C)_PDMC.*</drb:nameMatch>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- SAFE Manifest File           -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductSafeManifestFile">
      <rdfs:label xml:lang="en">User Product: SAFE Manifest File</rdfs:label>
      <rdfs:comment xml:lang="en">
         XML file with fixed name manifest.safe. This is the SAFE metadata file
         (optional). It is included in the product only if the user requests a
         SAFE product as output format (according to a specific download
         option).
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;safe-manifest"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>manifest.safe</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- GRANULE Folder               -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductGranuleFolder">
      <rdfs:label xml:lang="en">User Product: GRANULE Folder</rdfs:label>
      <rdfs:comment xml:lang="en">
         GRANULE folder contains the list of folders each one corresponding to
         the granules composing the user product.
         Level-0 User product: folder containing all granules composing the
         product (Image Data). The Image data are a set of annotated instrument
         source packets (ISP) corresponding to the compressed imaging data
         grouped in .'granules'. In the case of an extract, the image data
         (granules) are provided to cover the selected extract.
         The image data inside each Level-0 granule, are provided as a set of
         13 binary files, one for each spectral band, including all
         corresponding annotated Image Source Packets (ISP) in the observation
         chronological sequence.
         Level-1A and Level-1B User product: folder containing all granules
         composing the product (Image Data). The Image data are provided by a
         set of raster files. The image data extent correspond to a set of
         .'granules.' and can covers up to 12 detectors * 13 bands of the orbit
         in full resolution. A sub-set of the 13 bands can be provided.
         Level-1C User product: this folder (the name is chosen for homogeneity
         with respect to the other user product) contains the tiles composing
         the product (Image Data).
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>GRANULE</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- DATASTRIP Folder             -->
   <!-- ============================ -->

   <!-- TODO ATTENTION changement d'ID <owl:Class rdf:about="&s2;userProductDataStripFolder"> -->
   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductDatastripFolder">
      <rdfs:label xml:lang="en">User Product: DATASTRIP Folder</rdfs:label>
      <rdfs:comment xml:lang="en">
         DATASTRIP folder contains the list of folders each one corresponding
         to the Datastrips composing the user product.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>DATASTRIP</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- Auxiliary Data Folder        -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductAuxiliaryDataFolder">
      <rdfs:label xml:lang="en">User Product: Auxiliary Data Folder</rdfs:label>
      <rdfs:comment xml:lang="en">
         AUX_DATA folder contains the auxiliary data files used for the
         processing.
         Folder containing auxiliary data items needed for processing and
         provided with the product on request by the user. Some auxiliary data
         (for instance IERS Bullettin and GIPPs files) can be provided either
         with the product (if selected according to a specific download option)
         or external to the product (referenced through the
         Product_Metadata_File), others are only external to the product (for
         instance the DEM used for the processing); in any case, all these
         auxiliary data files are referenced in the XML Main metadata file.
         In addition, the Level-1C embeds always an elementary set of
         meteorological datasets extracted and resampled from ECMWF forecast
         output.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>AUX_DATA</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- Preview Image File           -->
   <!-- ============================ -->

   <!-- TODO TBC un PNG?
        This declaration is not verified... -->

   <owl:Class rdf:about="&s2;userProductPreviewImageFile">
      <rdfs:label xml:lang="en">User Product: Preview Image File</rdfs:label>
      <rdfs:comment xml:lang="en">
         File consisting of an image limited to 3 visible-bands in ground
         geometry at 320m resolution. This file, provided if required by the
         user, gives an overview of the product (sub-sampled) mainly for image
         data browsing and selection purposes.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&jpeg;JPEG"/>
      <drb:signature rdf:parseType="Resource">
         <!-- TBC l'extension devrait etre jp2 cf spec V06 p280) -->
         <drb:nameMatch>S2[AB]_...._PVI_MSI(L0P|L1A|L1B|L1C|TCI)_\d{3}_\d{14}_\d{14}_\d{4}\.(?i)jp[g2x]</drb:nameMatch>
         <drb:parentClassTest>&s2;userProduct</drb:parentClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- Rep Information Folder       -->
   <!-- ============================ -->

   <!-- TODO ATTENTION changement d'ID <owl:Class rdf:about="&s2;userProductRepInfoFolder"> -->
   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductRepresentationInformationFolder">
      <rdfs:label xml:lang="en">User Product: Representation Information Folder</rdfs:label>
      <rdfs:comment xml:lang="en">
         Folder containing the XSD schema provided inside the product. This
         folder is optional. It will be included in the final product if the
         user select the SAFE format as output format.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>rep_info</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- INSPIRE File                 -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductInspireFile">
      <rdfs:label xml:lang="en">User Product: INSPIRE File</rdfs:label>
      <rdfs:comment xml:lang="en">
         XML INSPIRE metadata file.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;xml"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameMatch>INSPIRE\..*</drb:nameMatch>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- HTML Folder                  -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductHtmlFolder">
      <rdfs:label xml:lang="en">User Product: HTML Folder</rdfs:label>
      <rdfs:comment xml:lang="en">
         HTML Folder.
         This folder contains two files:
         1. UserProduct_index.html
         2. UserProduct_index.xsl
         The first file is a product presentation file allowing the End User to display easily the main conte
         nt of the product.
         The second one represents the stylesheet used to generate the first one allowing the End User to dis
         play a selected sub-set of the product metadata.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>HTML</drb:nameTest>
         <drb:parentIsSubClassTest>&s2;userProduct</drb:parentIsSubClassTest>
      </drb:signature>
   </owl:Class>

   <!-- =================================================================== -->
   <!--                                                                     -->
   <!-- User Product Structure (Floor 2 and up)                             -->
   <!--                                                                     -->
   <!-- =================================================================== -->

   <!-- =========================================== -->
   <!-- Under HTML Folder                           -->
   <!-- =========================================== -->

   <!-- ============================ -->
   <!-- User Product HTML File       -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductHtmlFile">
      <rdfs:label xml:lang="en">User Product: HTML File</rdfs:label>
      <rdfs:comment xml:lang="en">
         This file is a product presentation file allowing the End User to
         display easily the main content of the product.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>UserProduct_index.html</drb:nameTest>
         <drb:parentClassTest>&s2;HTML</drb:parentClassTest>
      </drb:signature>
   </owl:Class>

   <!-- ============================ -->
   <!-- User Product XSL File        -->
   <!-- ============================ -->

   <!-- Compliant with COMPACT -->
   <owl:Class rdf:about="&s2;userProductXslFile">
      <rdfs:label xml:lang="en">User Product: XSL File</rdfs:label>
      <rdfs:comment xml:lang="en">
         This file represents the stylesheet used to generate the first one
         allowing the End User to display a selected sub-set of the product
         metadata.
      </rdfs:comment>
      <rdfs:subClassOf rdf:resource="&drb;item"/>
      <drb:signature rdf:parseType="Resource">
         <drb:nameTest>UserProduct_index.xsl</drb:nameTest>
         <drb:parentClassTest>&s2;HTML</drb:parentClassTest>
      </drb:signature>
   </owl:Class>

</rdf:RDF>
